<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grupo Euromex - Administrador de Correos</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="dashboard-page">
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo-icon">üìß</div>
                <h1>Grupo Euromex</h1>
            </div>
            <div class="user-section">
                <div class="user-info">
                    <div class="user-email" id="userEmail">Cargando...</div>
                </div>
                <button class="profile-button" onclick="showProfileMenu()">üë§ Perfil</button>
            </div>
        </div>
    </header>

    <!-- Men√∫ de Perfil -->
    <div class="profile-menu" id="profileMenu" style="display: none;">
        <div class="profile-menu-content">
            <div class="profile-menu-header">
                <h3>Perfil de Usuario</h3>
                <button class="close-profile-menu" onclick="hideProfileMenu()">‚úï</button>
            </div>
            <div class="profile-menu-body">
                <div class="profile-info">
                    <div class="profile-email" id="profileEmail">Cargando...</div>
                </div>
                <div class="profile-actions">
                    <button class="profile-action-btn" onclick="logout()">
                        üö™ Cerrar Sesi√≥n
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenido Principal -->
    <main class="main-content">
        <!-- Header del Contenido -->
            <div class="folder-tabs">
                <a href="#" class="folder-tab active" onclick="switchFolder('INBOX')">
                    üì• Inbox
                </a>
                <a href="#" class="folder-tab" onclick="switchFolder('SENT')">
                    üì§ Enviados
                </a>
                <a href="#" class="folder-tab" onclick="switchFolder('DRAFTS')">
                    üìù Borradores
                </a>
                <a href="#" class="folder-tab" onclick="switchFolder('TRASH')">
                    üóëÔ∏è Papelera
                </a>
            </div>
            <div class="content-header">
                <!-- Estructura original para web -->
                <div class="content-title">
                    <h2 id="currentFolderTitle">üì• Inbox</h2>
                    <div class="pagination-info" id="paginationInfo" style="display: none;">
                        <span id="emailCount">0</span> correos
                    </div>
                </div>
                <div class="content-actions">
                    <button class="btn btn-primary" onclick="showComposer()">
                        ‚úâÔ∏è Nuevo Email
                    </button>
                    <button class="btn btn-secondary" onclick="showProfileMenu()">
                        üë§ Perfil
                    </button>
                    <button class="btn btn-secondary" onclick="refreshEmails()">
                        üîÑ Actualizar
                    </button>
                    <div class="last-update-info" id="lastUpdateInfo">
                        √öltima actualizaci√≥n: <span id="lastUpdateTime">--:--</span>
                    </div>
                </div>
                
                <!-- Estructura m√≥vil -->
                <div class="mobile-line-1">
                    <div class="mobile-folder-title">
                        <h2 id="currentFolderTitleMobile">üì• Inbox</h2>
                        <div class="pagination-info" id="paginationInfoMobile" style="display: none;">
                            <span id="emailCountMobile">0</span> correos
                        </div>
                    </div>
                    <div class="mobile-last-update" id="lastUpdateInfoMobile">
                        √öltima actualizaci√≥n: <span id="lastUpdateTimeMobile">--:--</span>
                    </div>
                </div>
                
                <div class="mobile-line-2">
                    <button class="btn btn-primary" onclick="showComposer()">
                        ‚úâÔ∏è Nuevo Email
                    </button>
                    <button class="btn btn-secondary" onclick="showProfileMenu()">
                        üë§ Perfil
                    </button>
                    <button class="btn btn-secondary" onclick="refreshEmails()">
                        üîÑ Actualizar
                    </button>
                </div>
                
                <div class="pagination-controls" id="paginationControls" style="display: none;">
                    <button class="btn btn-icon" onclick="previousPage()" id="prevPageBtn" disabled>
                        ‚Üê
                    </button>
                    <span class="page-indicator" id="pageIndicator">P√°g. 1</span>
                    <button class="btn btn-icon" onclick="nextPage()" id="nextPageBtn" disabled>
                        ‚Üí
                    </button>
                </div>
        </div>

        <!-- Lista de Emails -->
        <div class="email-list" id="emailList">
            <div class="email-list-header">
                <div class="header-checkbox">
                    <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                </div>
                <div class="header-from">De</div>
                <div class="header-subject">Asunto</div>
                <div class="header-attachment">Adjuntos</div>
                <div class="header-date">Fecha</div>
                <div class="header-actions">Acciones</div>
            </div>
            <div id="emailListContent">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    Cargando emails...
                </div>
            </div>
        </div>
    </main>

    <!-- Modal de Email -->
    <div id="emailModal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Email</div>
                <button class="modal-close" onclick="closeEmailModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Contenido del email se carga aqu√≠ -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="replyToEmail()">
                    üìß Responder
                </button>
                <button class="btn btn-secondary" onclick="closeEmailModal()">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Composer -->
    <div id="composerModal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Nuevo Email</div>
                <button class="modal-close" onclick="closeComposer()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="composer">
                    <div class="composer-body">
                        <form id="composerForm" class="composer-form">
                            <div class="composer-row">
                                <label class="composer-label">Para:</label>
                                <div class="autocomplete-container">
                                    <input type="email" class="composer-input" id="composerTo" required autocomplete="off">
                                    <div id="autocompleteDropdown" class="autocomplete-dropdown" style="display: none;"></div>
                                </div>
                            </div>
                            <div class="composer-row cc-bcc-group" id="ccBccGroup" style="display: none;">
                                <label class="composer-label">CC:</label>
                                <div class="autocomplete-container">
                                    <input type="email" class="composer-input" id="composerCc" autocomplete="off">
                                    <div id="autocompleteDropdownCc" class="autocomplete-dropdown" style="display: none;"></div>
                                </div>
                            </div>
                            <div class="composer-row cc-bcc-group" id="ccBccGroup2" style="display: none;">
                                <label class="composer-label">CCO:</label>
                                <div class="autocomplete-container">
                                    <input type="email" class="composer-input" id="composerBcc" autocomplete="off">
                                    <div id="autocompleteDropdownBcc" class="autocomplete-dropdown" style="display: none;"></div>
                                </div>
                            </div>
                            <div class="composer-row">
                                <button type="button" class="btn btn-link" id="toggleCcBcc" onclick="toggleCcBccAlternative()">
                                    + CC, CCO
                                </button>
                            </div>
                            <div class="composer-row">
                                <label class="composer-label">Asunto:</label>
                                <input type="text" class="composer-input" id="composerSubject" required>
                            </div>
                            <div class="composer-row">
                                <label class="composer-label">Mensaje:</label>
                                <textarea class="composer-input composer-textarea" id="composerMessage" required></textarea>
                            </div>
                            <div class="composer-row">
                                <label class="composer-label">Adjuntos:</label>
                                <div class="attachment-container">
                                    <input type="file" class="attachment-input" id="attachmentInput" multiple accept="image/*,.pdf,.doc,.docx,.txt">
                                    <label for="attachmentInput" class="attachment-label">
                                        üìé Seleccionar archivos
                                    </label>
                                    <div id="attachmentList" class="attachment-list"></div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="sendEmail()">
                    üì§ Enviar
                </button>
                <button class="btn btn-secondary" onclick="closeComposer()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Credenciales DESACTIVADO en MVP -->
    <div id="credentialsModal" class="modal-overlay" style="display: none !important;">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Verificaci√≥n de Credenciales</div>
                <button class="modal-close" onclick="closeCredentialsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Para realizar esta operaci√≥n, necesitamos verificar tus credenciales:</p>
                <form id="credentialsForm">
                    <div class="form-group">
                        <label for="credentialsEmail">Email:</label>
                        <input type="text" id="credentialsEmail" class="composer-input" placeholder="nombre@grupoeuromex.com" required>
                    </div>
                    <div class="form-group">
                        <label for="credentialsPassword">Contrase√±a:</label>
                        <input type="password" id="credentialsPassword" class="composer-input" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="confirmCredentials()">
                    ‚úÖ Confirmar
                </button>
                <button class="btn btn-secondary" onclick="closeCredentialsModal()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Configuraci√≥n de Perfil -->
    <div id="profileModal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Configuraci√≥n de Perfil</div>
                <button class="modal-close" onclick="closeProfileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="profileForm">
                    <div class="form-group">
                        <label for="profileName">Nombre completo:</label>
                        <input type="text" id="profileName" class="form-input" placeholder="Tu nombre completo" required>
                    </div>
                    <div class="form-group" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                        <label>
                            <input type="checkbox" id="signatureEnabled" onchange="toggleSignatureOptions()">
                            Activar firma autom√°tica con imagen
                        </label>
                    </div>
                    <div id="signatureOptions" class="signature-options" style="display: none;">
                        <div class="form-group">
                            <label for="signatureImage">Imagen de firma:</label>
                            <input type="file" id="signatureImage" accept="image/*" onchange="previewSignatureImage()">
                            <small style="color: var(--text-light); margin-top: 8px; display: block;">
                                La imagen se agregar√° autom√°ticamente a todos tus emails enviados
                            </small>
                            <div id="signaturePreview" class="signature-preview" style="display: none;">
                                <img id="signaturePreviewImg" alt="Vista previa de la firma">
                                <button type="button" onclick="removeSignatureImage()">Eliminar imagen</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="saveProfile()">
                    üíæ Guardar Perfil
                </button>
                <button class="btn btn-secondary" onclick="closeProfileModal()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
